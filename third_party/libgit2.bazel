cc_library(
    name = "git2",
    srcs = glob([
        "hash/*.h",
        "transports/*.h",
        "unix/*.h",
        "xdiff/*.h",
    ] + [
        "annotated_commit.c",
        "apply.c",
        "attr.c",
        "attr_file.c",
        "attrcache.c",
        "blame.c",
        "blame_git.c",
        "blob.c",
        "branch.c",
        "buf_text.c",
        "buffer.c",
        "cache.c",
        "checkout.c",
        "cherrypick.c",
        "clone.c",
        "commit.c",
        "commit_list.c",
        "config.c",
        "config_cache.c",
        "config_file.c",
        "crlf.c",
        "curl_stream.c",
        "date.c",
        "delta.c",
        "describe.c",
        "diff.c",
        "diff_driver.c",
        "diff_file.c",
        "diff_generate.c",
        "diff_parse.c",
        "diff_print.c",
        "diff_stats.c",
        "diff_tform.c",
        "diff_xdiff.c",
        "errors.c",
        "fetch.c",
        "fetchhead.c",
        "filebuf.c",
        "fileops.c",
        "filter.c",
        "fnmatch.c",
        "global.c",
        "graph.c",
        "hash.c",
        "hashsig.c",
        "ident.c",
        "idxmap.c",
        "ignore.c",
        "index.c",
        "indexer.c",
        "iterator.c",
        "merge.c",
        "merge_driver.c",
        "merge_file.c",
        "message.c",
        "mwindow.c",
        "netops.c",
        "notes.c",
        "object.c",
        "object_api.c",
        "odb.c",
        "odb_loose.c",
        "odb_mempack.c",
        "odb_pack.c",
        "offmap.c",
        "oid.c",
        "oidarray.c",
        "oidmap.c",
        "openssl_stream.c",
        "pack-objects.c",
        "pack.c",
        "patch.c",
        "patch_generate.c",
        "patch_parse.c",
        "path.c",
        "pathspec.c",
        "pool.c",
        "posix.c",
        "pqueue.c",
        "proxy.c",
        "push.c",
        "rebase.c",
        "refdb.c",
        "refdb_fs.c",
        "reflog.c",
        "refs.c",
        "refspec.c",
        "remote.c",
        "repository.c",
        "reset.c",
        "revert.c",
        "revparse.c",
        "revwalk.c",
        "settings.c",
        "sha1_lookup.c",
        "signature.c",
        "socket_stream.c",
        "sortedcache.c",
        "stash.c",
        "status.c",
        "stransport_stream.c",
        "strmap.c",
        "submodule.c",
        "sysdir.c",
        "tag.c",
        "thread-utils.c",
        "tls_stream.c",
        "trace.c",
        "transaction.c",
        "transport.c",
        "tree-cache.c",
        "tree.c",
        "tsort.c",
        "util.c",
        "varint.c",
        "vector.c",
        "worktree.c",
        "zstream.c",
        "transports/auth.c",
        "transports/auth_negotiate.c",
        "transports/cred.c",
        "transports/cred_helpers.c",
        "transports/git.c",
        "transports/http.c",
        "transports/local.c",
        "transports/smart.c",
        "transports/smart_pkt.c",
        "transports/smart_protocol.c",
        "transports/ssh.c",
        "transports/winhttp.c",
        "xdiff/xdiffi.c",
        "xdiff/xemit.c",
        "xdiff/xhistogram.c",
        "xdiff/xmerge.c",
        "xdiff/xpatience.c",
        "xdiff/xprepare.c",
        "xdiff/xutils.c",
        "unix/map.c",
        "unix/realpath.c",
    ]),
    hdrs = glob([
        "*.h",
    ]),
    defines = [
        "GIT_CURL",
        "GIT_HTTPS",
        "GIT_OPENSSL",
        "GIT_SHA1_OPENSSL",
        "GIT_SSH",
        "GIT_SSH_MEMORY_CREDENTIALS",
        "GIT_THREADS",
        "GIT_USE_NSEC",
        "GIT_USE_STAT_MTIM",
        "HAVE_FUTIMENS",
        "HAVE_QSORT_R",
        "_FILE_OFFSET_BITS=64",
        "git2_EXPORTS",
    ],
    includes = [
        ".",
    ],
    linkopts = [
        "-lcurl",
        "-lhttp_parser",
        "-lz",
        "-lssl",
        "-lcrypto",
        "-lssh2",
        "-lrt",
        "-lpthread",
    ],
    visibility = [
        "//visibility:public",
    ],
)
