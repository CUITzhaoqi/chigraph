cc_library(
    name = "git2",
    srcs = glob([
        "src/*.h",
        "src/hash/*.h",
        "src/transports/*.h",
        "src/unix/*.h",
        "src/xdiff/*.h",
    ] + [
        "src/annotated_commit.c",
        "src/apply.c",
        "src/attr.c",
        "src/attr_file.c",
        "src/attrcache.c",
        "src/blame.c",
        "src/blame_git.c",
        "src/blob.c",
        "src/branch.c",
        "src/buf_text.c",
        "src/buffer.c",
        "src/cache.c",
        "src/checkout.c",
        "src/cherrypick.c",
        "src/clone.c",
        "src/commit.c",
        "src/commit_list.c",
        "src/config.c",
        "src/config_cache.c",
        "src/config_file.c",
        "src/crlf.c",
        "src/curl_stream.c",
        "src/date.c",
        "src/delta.c",
        "src/describe.c",
        "src/diff.c",
        "src/diff_driver.c",
        "src/diff_file.c",
        "src/diff_generate.c",
        "src/diff_parse.c",
        "src/diff_print.c",
        "src/diff_stats.c",
        "src/diff_tform.c",
        "src/diff_xdiff.c",
        "src/errors.c",
        "src/fetch.c",
        "src/fetchhead.c",
        "src/filebuf.c",
        "src/fileops.c",
        "src/filter.c",
        "src/fnmatch.c",
        "src/global.c",
        "src/graph.c",
        "src/hash.c",
        "src/hashsig.c",
        "src/ident.c",
        "src/idxmap.c",
        "src/ignore.c",
        "src/index.c",
        "src/indexer.c",
        "src/iterator.c",
        "src/merge.c",
        "src/merge_driver.c",
        "src/merge_file.c",
        "src/message.c",
        "src/mwindow.c",
        "src/netops.c",
        "src/notes.c",
        "src/object.c",
        "src/object_api.c",
        "src/odb.c",
        "src/odb_loose.c",
        "src/odb_mempack.c",
        "src/odb_pack.c",
        "src/offmap.c",
        "src/oid.c",
        "src/oidarray.c",
        "src/oidmap.c",
        "src/openssl_stream.c",
        "src/pack-objects.c",
        "src/pack.c",
        "src/patch.c",
        "src/patch_generate.c",
        "src/patch_parse.c",
        "src/path.c",
        "src/pathspec.c",
        "src/pool.c",
        "src/posix.c",
        "src/pqueue.c",
        "src/proxy.c",
        "src/push.c",
        "src/rebase.c",
        "src/refdb.c",
        "src/refdb_fs.c",
        "src/reflog.c",
        "src/refs.c",
        "src/refspec.c",
        "src/remote.c",
        "src/repository.c",
        "src/reset.c",
        "src/revert.c",
        "src/revparse.c",
        "src/revwalk.c",
        "src/settings.c",
        "src/sha1_lookup.c",
        "src/signature.c",
        "src/socket_stream.c",
        "src/sortedcache.c",
        "src/stash.c",
        "src/status.c",
        "src/stransport_stream.c",
        "src/strmap.c",
        "src/submodule.c",
        "src/sysdir.c",
        "src/tag.c",
        "src/thread-utils.c",
        "src/tls_stream.c",
        "src/trace.c",
        "src/transaction.c",
        "src/transport.c",
        "src/tree-cache.c",
        "src/tree.c",
        "src/tsort.c",
        "src/util.c",
        "src/varint.c",
        "src/vector.c",
        "src/worktree.c",
        "src/zstream.c",
        "src/transports/auth.c",
        "src/transports/auth_negotiate.c",
        "src/transports/cred.c",
        "src/transports/cred_helpers.c",
        "src/transports/git.c",
        "src/transports/http.c",
        "src/transports/local.c",
        "src/transports/smart.c",
        "src/transports/smart_pkt.c",
        "src/transports/smart_protocol.c",
        "src/transports/ssh.c",
        "src/transports/winhttp.c",
        "src/xdiff/xdiffi.c",
        "src/xdiff/xemit.c",
        "src/xdiff/xhistogram.c",
        "src/xdiff/xmerge.c",
        "src/xdiff/xpatience.c",
        "src/xdiff/xprepare.c",
        "src/xdiff/xutils.c",
        "src/unix/map.c",
        "src/unix/realpath.c",
    ]),
    hdrs = glob([
        "*.h",
    ]),
    defines = [
        "GIT_CURL",
        "GIT_HTTPS",
        "GIT_OPENSSL",
        "GIT_SHA1_OPENSSL",
        "GIT_SSH",
        "GIT_SSH_MEMORY_CREDENTIALS",
        "GIT_THREADS",
        "GIT_USE_NSEC",
        "GIT_USE_STAT_MTIM",
        "HAVE_FUTIMENS",
        "HAVE_QSORT_R",
        "_FILE_OFFSET_BITS=64",
        "git2_EXPORTS",
    ],
    includes = [
        "include",
        "src",
    ],
    linkopts = [
        "-lcurl",
        "-lhttp_parser",
        "-lz",
        "-lssl",
        "-lcrypto",
        "-lssh2",
        "-lrt",
        "-lpthread",
    ],
    visibility = [
        "//visibility:public",
    ],
)
